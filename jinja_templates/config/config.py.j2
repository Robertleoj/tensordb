"""
Auto-generated configuration file generated from {{config_path}}.

Do not edit this file directly. Instead, edit the configuration file
and re-run the build process to regenerate this file.
"""
from dataclasses import dataclass, field

{% macro default_value(value)-%}
{%- if not is_ref(value) -%}
    {{value.__repr__()}}
{%- else -%}
    field(init=False, default_factory=lambda: {{ value.__repr__() }})
{%- endif %}
{%- endmacro -%}

{%- macro generate_dataclass(class_name, dict, indent_level=0) -%}
{%- set indent = '    ' * indent_level %}
{{ indent }}@dataclass(frozen=True)
{{ indent }}class {{ class_name }}:
{%- for key, value in dict.items() %}
{%- if value is mapping %}
{{ generate_dataclass('_' + key, value, indent_level+1) }}
{{ indent }}    {{ key }}: {{ '_' + key }} = field(init=False,default_factory={{'_' + key}})
{%- else %}
{{ indent }}    {{ key }}: {{ value.__class__.__name__ }} = {{ default_value(value) }}
{%- endif %}
{%- endfor %}
{%- endmacro %}
{{ generate_dataclass('Config', dictionary) }}

CONFIG = Config()
